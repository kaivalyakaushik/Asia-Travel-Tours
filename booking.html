<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Book Now - Asia Travel Tours</title>
<script src="auth.js"></script>
<script>requireLogin();</script>

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:Arial,sans-serif;background:#1a1a1a}
header{background:#0066cc;color:#ffd700;padding:20px;text-align:center}
.container{max-width:500px;margin:30px auto;padding:20px}

.back-btn{
display:inline-block;margin-bottom:20px;padding:10px 20px;
background:#0066cc;color:#ffd700;text-decoration:none;border-radius:5px
}

.form-box{background:white;padding:30px;border-radius:10px}
h2{color:#0066cc;margin-bottom:20px;text-align:center}
label{display:block;margin:15px 0 5px;color:#333;font-weight:bold}
input,select,textarea{
width:100%;padding:10px;border:1px solid #ccc;border-radius:5px
}
textarea{height:80px}

button{
width:100%;padding:15px;background:#ffd700;color:#000;
border:none;border-radius:5px;font-size:16px;font-weight:bold;
cursor:pointer;margin-top:20px
}
button:hover{background:#ffed4e}

.payment-box{
margin-top:25px;padding-top:20px;border-top:2px dashed #ccc
}

.payment-option{margin:10px 0}

.message{
display:none;background:#4CAF50;color:white;padding:15px;
border-radius:5px;margin-bottom:20px;text-align:center
}

.processing{
display:none;background:#0066cc;color:#ffd700;
padding:15px;border-radius:5px;text-align:center;margin-bottom:20px
}
</style>
</head>

<body>

<header>
<h1>Asia Travel Tours</h1>
</header>

<div class="container">
<a href="index.html" class="back-btn">← Back</a>

<div class="message" id="successMsg">
✅ Booking Confirmed! Payment Successful.
</div>

<div class="processing" id="processingMsg">
⏳ Processing Payment...
</div>

<div class="form-box">
<h2>Book Your Tour</h2>

<form onsubmit="processPayment(event)">

<label>Name</label>
<input type="text" id="name" required>

<label>Email</label>
<input type="email" id="email" required>

<label>Phone</label>
<input type="tel" id="phone" required>

<label>Destination</label>
<select id="destination" required>
<option value="">Select destination</option>
<option>Tokyo, Japan - ₹95,000</option>
<option>Bali, Indonesia - ₹65,000</option>
<option>Dubai, UAE - ₹75,000</option>
<option>Bangkok, Thailand - ₹55,000</option>
<option>Singapore - ₹70,000</option>
<option>Kathmandu, Nepal - ₹45,000</option>
</select>

<label>Travel Date</label>
<input type="date" id="date" required>

<label>Number of People</label>
<input type="number" id="people" min="1" max="20" value="1" required>

<label>Message</label>
<textarea></textarea>

<!-- PAYMENT SECTION -->
<div class="payment-box">
<h3 style="color:#0066cc;text-align:center">Payment Details</h3>

<div class="payment-option">
<input type="radio" name="pay" value="card" checked onchange="togglePayment()"> Debit / Credit Card
</div>

<div id="cardFields">
<label>Card Number</label>
<input type="text" id="cardNumber">

<label>Expiry Date</label>
<input type="month" id="expiry">

<label>CVV</label>
<input type="password" id="cvv">
</div>

<div class="payment-option" style="margin-top:15px">
<input type="radio" name="pay" value="upi" onchange="togglePayment()"> UPI (Fake)
</div>

<div id="upiFields" style="display:none">
<label>UPI ID</label>
<input type="text" id="upi" placeholder="example@upi">
</div>
</div>

<button type="submit">Pay & Book</button>
</form>
</div>
</div>

<script>
function togglePayment(){
const method = document.querySelector('input[name="pay"]:checked').value;

document.getElementById("cardFields").style.display =
method === "card" ? "block" : "none";

document.getElementById("upiFields").style.display =
method === "upi" ? "block" : "none";

document.getElementById("cardNumber").required = method === "card";
document.getElementById("expiry").required = method === "card";
document.getElementById("cvv").required = method === "card";
document.getElementById("upi").required = method === "upi";
}

function processPayment(event){
event.preventDefault();

document.getElementById("processingMsg").style.display="block";

setTimeout(function(){

document.getElementById("processingMsg").style.display="none";
document.getElementById("successMsg").style.display="block";

/* SAVE BOOKING */
let tickets = JSON.parse(localStorage.getItem("myTickets")) || [];

tickets.push({
name: name.value,
email: email.value,
phone: phone.value,
destination: destination.value,
date: date.value,
people: people.value,
payment: document.querySelector('input[name="pay"]:checked').value.toUpperCase(),
bookingDate: new Date().toLocaleString()
,status: "CONFIRMED",
});

localStorage.setItem("myTickets", JSON.stringify(tickets));

event.target.reset();
togglePayment();

/* REDIRECT TO RECEIPT */
setTimeout(function(){
window.location.href = "receipt.html";
},2000);

},2000);
}

togglePayment();
</script>

</body>
</html>
